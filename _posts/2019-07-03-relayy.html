<html>
<head>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>


	</head>

	<body>


		<div class="login-box">
  <h1>Hackthebox buff Writeup</h1>
            <p><p><img alt="" src="https://0xprashant.github.io/hackthebox-images/buff.png" style="height:182px; width:300px" /></p>

<p>This Machine is Currently Active</p>

<p>Decrypt it with NTLM hash of user administrator</p>

<p>Use msf hashdump or follow to get the hash&nbsp;<a href="http://0xprashant.github.io/pages/windows-decryption/">Dumping-Hash</a></p>

<p>4c8****************************f8</p>


<div class="textbox">
    <i class="fas fa-lock"></i>
    <form id="staticrypt-form" action="#" method="post">
    <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="NTLM-Hash"
                   autofocus/>
  </div>

  <input type="submit" class="btn" value="DECRYPT"/>
  </form>
</div>




		<script>

			document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
        	e.preventDefault();
        	var passphrase = document.getElementById('staticrypt-password').value;

			var encrypted = CryptoJS.AES.encrypt('LS0tCnRpdGxlOiBUZXh0IGFuZCBUeXBvZ3JhcGh5CmF1dGhvcjogQ290ZXMgQ2h1bmcKZGF0ZTogMjAxOS0wOC0wOCAxMTozMzowMCArMDgwMApjYXRlZ29yaWVzOiBbQmxvZ2dpbmcsIERlbW8sIEhhY2tpbmddCnRhZ3M6IFt0eXBvZ3JhcGh5LCBIYWNraW5nXQptYXRoOiB0cnVlCmltYWdlOiAvYXNzZXRzL2ltZy9zYW1wbGUvZGV2aWNlcy1tb2NrdXAucG5nCi0tLQoKVGhpcyBwb3N0IGlzIHRvIHNob3cgTWFya2Rvd24gc3ludGF4IHJlbmRlcmluZyBvbiBbKipDaGlycHkqKl0oaHR0cHM6Ly9naXRodWIuY29tL2NvdGVzMjAyMC9qZWt5bGwtdGhlbWUtY2hpcnB5L2ZvcmspLCB5b3UgY2FuIGFsc28gdXNlIGl0IGFzIGFuIGV4YW1wbGUgb2Ygd3JpdGluZy4gTm93LCBsZXQncyBzdGFydCBsb29raW5nIGF0IHRleHQgYW5kIHR5cG9ncmFwaHkuCgojIyBUaXRsZXMKCi0tLQoKIyBIMQoKPGgyIGRhdGEtdG9jLXNraXA+SDI8L2gyPgoKPGgzIGRhdGEtdG9jLXNraXA+SDM8L2gzPgoKPGg0Pkg0PC9oND4KCi0tLQoKIyMgUGFyYWdyYXBoCgpJIHdhbmRlcmVkIGxvbmVseSBhcyBhIGNsb3VkCgpUaGF0IGZsb2F0cyBvbiBoaWdoIG8nZXIgdmFsZXMgYW5kIGhpbGxzLAoKV2hlbiBhbGwgYXQgb25jZSBJIHNhdyBhIGNyb3dkLAoKQSBob3N0LCBvZiBnb2xkZW4gZGFmZm9kaWxzOwoKQmVzaWRlIHRoZSBsYWtlLCBiZW5lYXRoIHRoZSB0cmVlcywKCkZsdXR0ZXJpbmcgYW5kIGRhbmNpbmcgaW4gdGhlIGJyZWV6ZS4KCiMjIExpc3QKCiMjIyBPcmRlcmVkIGxpc3QKCjEuIGZpcnN0IGl0ZW0KMi4gc2Vjb25kIGl0ZW0KMy4gdGhpcmQgaXRlbQoKIyMjIFVub3JkZXJlZCBsaXN0CgotIGl0ZW0gMQoJLSBzdWIgaXRlbSAxCgktIHN1YiBpdGVtIDIKCi0gaXRlbSAyCgojIyBCbG9jayBRdW90ZQoKPiBUaGlzIGxpbmUgdG8gc2hvd3MgdGhlIEJsb2NrIFF1b3RlLgoKIyMgVGFibGVzCgp8IENvbXBhbnkgICAgICAgICAgICAgICAgICAgICAgfCBjb250YWN0ICAgICAgICAgIHwgQ291bnRyeSB8Cnw6LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18Oi0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tOnwKfCBBbGZyZWRzIEZ1dHRlcmtpc3RlICAgICAgICAgIHwgTWFyaWEgQW5kZXJzICAgICB8IEdlcm1hbnkgfAp8IElzbGFuZCBUcmFkaW5nICAgICAgICAgICAgICAgfCBIZWxlbiBCZW5uZXR0ICAgIHwgVUsgICAgICB8CnwgTWFnYXp6aW5pIEFsaW1lbnRhcmkgUml1bml0aSB8IEdpb3Zhbm5pIFJvdmVsbGkgfCBJdGFseSAgIHwKCiMjIExpbmsKCjxodHRwOi8vMTI3LjAuMC4xOjQwMDA+CgoKIyMgRm9vdG5vdGUKCkNsaWNrIHRoZSBob29rIHdpbGwgbG9jYXRlIHRoZSBmb290bm90ZVteZm9vdG5vdGVdLgoKCiMjIEltYWdlcwoKQnkgZGVmYXVsdCwgdGhlIGltYWdlIGlzIGNlbnRlcmVkIGFuZCB0aGUgaW1hZ2UgY2FwdGlvbiBjYW4gYmUgZGlzcGxheWVkIGF0IHRoZSBib3R0b206CgohW0Rlc2t0b3AgVmlld10oL2Fzc2V0cy9pbWcvc2FtcGxlL21vY2t1cC5wbmcpCl9GdWxsIHNjcmVlbiB3aWR0aCBhbmQgY2VudGVyIGFsaWdubWVudF8KCllvdSBjYW4gY2hhbmdlIHRoZSBzaXplIG9mIHRoZSBwaWN0dXJlOgoKIVtEZXNrdG9wIFZpZXddKC9hc3NldHMvaW1nL3NhbXBsZS9tb2NrdXAucG5nKXs6IHdpZHRoPSI0MDAifQpfNDAwcHggaW1hZ2Ugd2lkdGhfCgpJbiBhZGRpdGlvbiwgeW91IGNhbiB1c2UgY2xhc3MgYG5vcm1hbGAgLCBgbGVmdGAgYW5kIGByaWdodGAgdG8gc3BlY2lmeSB0aGUgaW1hZ2UgcG9zaXRpb24gKGJ1dCBpbiB0aGVzZSBjYXNlLCB0aGUgaW1hZ2UgY2FwdGlvbiBpcyBwcm9oaWJpdGVkKSwgZm9yIGV4YW1wbGU6CgotIE5vcm1hbCBwb3NpdGlvbgogIAogICFbRGVza3RvcCBWaWV3XSgvYXNzZXRzL2ltZy9zYW1wbGUvbW9ja3VwLnBuZyl7OiB3aWR0aD0iMzUwIiBjbGFzcz0ibm9ybWFsIn0KCi0gRmxvYXQgdG8gdGhlIGxlZnQKCiAgIVtEZXNrdG9wIFZpZXddKC9hc3NldHMvaW1nL3NhbXBsZS9tb2NrdXAucG5nKXs6IHdpZHRoPSIyNDAiIGNsYXNzPSJsZWZ0In0KICAiQSByZXBldGl0aXZlIGFuZCBtZWFuaW5nbGVzcyB0ZXh0IGlzIHVzZWQgdG8gZmlsbCB0aGUgc3BhY2UuIEEgcmVwZXRpdGl2ZSBhbmQgbWVhbmluZ2xlc3MgdGV4dCBpcyB1c2VkIHRvIGZpbGwgdGhlIHNwYWNlLiBBIHJlcGV0aXRpdmUgYW5kIG1lYW5pbmdsZXNzIHRleHQgaXMgdXNlZCB0byBmaWxsIHRoZSBzcGFjZS4gQSByZXBldGl0aXZlIGFuZCBtZWFuaW5nbGVzcyB0ZXh0IGlzIHVzZWQgdG8gZmlsbCB0aGUgc3BhY2UuIEEgcmVwZXRpdGl2ZSBhbmQgbWVhbmluZ2xlc3MgdGV4dCBpcyB1c2VkIHRvIGZpbGwgdGhlIHNwYWNlLiBBIHJlcGV0aXRpdmUgYW5kIG1lYW5pbmdsZXNzIHRleHQgaXMgdXNlZCB0byBmaWxsIHRoZSBzcGFjZS4gQSByZXBldGl0aXZlIGFuZCBtZWFuaW5nbGVzcyB0ZXh0IGlzIHVzZWQgdG8gZmlsbCB0aGUgc3BhY2UuIEEgcmVwZXRpdGl2ZSBhbmQgbWVhbmluZ2xlc3MgdGV4dCBpcyB1c2VkIHRvIGZpbGwgdGhlIHNwYWNlLiBBIHJlcGV0aXRpdmUgYW5kIG1lYW5pbmdsZXNzIHRleHQgaXMgdXNlZCB0byBmaWxsIHRoZSBzcGFjZS4gQSByZXBldGl0aXZlIGFuZCBtZWFuaW5nbGVzcyB0ZXh0IGlzIHVzZWQgdG8gZmlsbCB0aGUgc3BhY2UuIEEgcmVwZXRpdGl2ZSBhbmQgbWVhbmluZ2xlc3MgdGV4dCBpcyB1c2VkIHRvIGZpbGwgdGhlIHNwYWNlLiBBIHJlcGV0aXRpdmUgYW5kIG1lYW5pbmdsZXNzIHRleHQgaXMgdXNlZCB0byBmaWxsIHRoZSBzcGFjZS4iCgotIEZsb2F0IHRvIHRoZSByaWdodAoKICAhW0Rlc2t0b3AgVmlld10oL2Fzc2V0cy9pbWcvc2FtcGxlL21vY2t1cC5wbmcpezogd2lkdGg9IjI0MCIgY2xhc3M9InJpZ2h0In0KICAiQSByZXBldGl0aXZlIGFuZCBtZWFuaW5nbGVzcyB0ZXh0IGlzIHVzZWQgdG8gZmlsbCB0aGUgc3BhY2UuIEEgcmVwZXRpdGl2ZSBhbmQgbWVhbmluZ2xlc3MgdGV4dCBpcyB1c2VkIHRvIGZpbGwgdGhlIHNwYWNlLiBBIHJlcGV0aXRpdmUgYW5kIG1lYW5pbmdsZXNzIHRleHQgaXMgdXNlZCB0byBmaWxsIHRoZSBzcGFjZS4gQSByZXBldGl0aXZlIGFuZCBtZWFuaW5nbGVzcyB0ZXh0IGlzIHVzZWQgdG8gZmlsbCB0aGUgc3BhY2UuIEEgcmVwZXRpdGl2ZSBhbmQgbWVhbmluZ2xlc3MgdGV4dCBpcyB1c2VkIHRvIGZpbGwgdGhlIHNwYWNlLiBBIHJlcGV0aXRpdmUgYW5kIG1lYW5pbmdsZXNzIHRleHQgaXMgdXNlZCB0byBmaWxsIHRoZSBzcGFjZS4gQSByZXBldGl0aXZlIGFuZCBtZWFuaW5nbGVzcyB0ZXh0IGlzIHVzZWQgdG8gZmlsbCB0aGUgc3BhY2UuIEEgcmVwZXRpdGl2ZSBhbmQgbWVhbmluZ2xlc3MgdGV4dCBpcyB1c2VkIHRvIGZpbGwgdGhlIHNwYWNlLiBBIHJlcGV0aXRpdmUgYW5kIG1lYW5pbmdsZXNzIHRleHQgaXMgdXNlZCB0byBmaWxsIHRoZSBzcGFjZS4gQSByZXBldGl0aXZlIGFuZCBtZWFuaW5nbGVzcyB0ZXh0IGlzIHVzZWQgdG8gZmlsbCB0aGUgc3BhY2UuIEEgcmVwZXRpdGl2ZSBhbmQgbWVhbmluZ2xlc3MgdGV4dCBpcyB1c2VkIHRvIGZpbGwgdGhlIHNwYWNlLiBBIHJlcGV0aXRpdmUgYW5kIG1lYW5pbmdsZXNzIHRleHQgaXMgdXNlZCB0byBmaWxsIHRoZSBzcGFjZS4iCgojIyBJbmxpbmUgY29kZQoKVGhpcyBpcyBhbiBleGFtcGxlIG9mIGBJbmxpbmUgQ29kZWAuCgojIyBNYXRoZW1hdGljcwoKVGhlIG1hdGhlbWF0aWNzIHBvd2VyZWQgYnkgWyoqTWF0aEpheCoqXShodHRwczovL3d3dy5tYXRoamF4Lm9yZy8pOgoKJCQgXHN1bV97bj0xfV5caW5mdHkgMS9uXjIgPSBcZnJhY3tccGleMn17Nn0gJCQKCldoZW4gXFwoYSBcbmUgMFxcKSwgdGhlcmUgYXJlIHR3byBzb2x1dGlvbnMgdG8gXFwoYXheMiArIGJ4ICsgYyA9IDBcXCkgYW5kIHRoZXkgYXJlCgokJCB4ID0gey1iIFxwbSBcc3FydHtiXjItNGFjfSBcb3ZlciAyYX0gJCQKCiMjIENvZGUgU25pcHBldAoKIyMjIENvbW1vbgoKYGBgClRoaXMgaXMgYSBjb21tb24gY29kZSBzbmlwcGV0LCB3aXRob3V0IHN5bnRheCBoaWdobGlnaHQgYW5kIGxpbmUgbnVtYmVyLgpgYGAKCiMjIyBTcGVjaWZpYyBMYW5ndWFnZXMKCiMjIyMgQ29uc29sZQoKYGBgY29uc29sZQokIGRhdGUKU3VuIE5vdiAgMyAxNToxMToxMiBDU1QgMjAxOQpgYGAKCgojIyMjIFRlcm1pbmFsCgpgYGB0ZXJtaW5hbAokIGVudiB8Z3JlcCBTSEVMTApTSEVMTD0vdXNyL2xvY2FsL2Jpbi9iYXNoClBZRU5WX1NIRUxMPWJhc2gKYGBgCgojIyMjIFJ1YnkKCmBgYHJ1YnkKZGVmIHN1bV9lcV9uPyhhcnIsIG4pCiAgcmV0dXJuIHRydWUgaWYgYXJyLmVtcHR5PyAmJiBuID09IDAKICBhcnIucHJvZHVjdChhcnIpLnJlamVjdCB7IHxhLGJ8IGEgPT0gYiB9LmFueT8geyB8YSxifCBhICsgYiA9PSBuIH0KZW5kCmBgYAoKIyMjIyBTaGVsbAoKYGBgc2hlbGwKaWYgWyAkPyAtbmUgMCBdOyB0aGVuCiAgICBlY2hvICJUaGUgY29tbWFuZCB3YXMgbm90IHN1Y2Nlc3NmdWwuIjsKICAgICNkbyB0aGUgbmVlZGZ1bCAvIGV4aXQKZmk7CmBgYAoKIyMjIyBMaXF1aWQKCnslIHJhdyAlfQpgYGBsaXF1aWQKeyUgaWYgcHJvZHVjdC50aXRsZSBjb250YWlucyAnUGFjaycgJX0KICBUaGlzIHByb2R1Y3QncyB0aXRsZSBjb250YWlucyB0aGUgd29yZCBQYWNrLgp7JSBlbmRpZiAlfQpgYGAKeyUgZW5kcmF3ICV9CgojIyMjIEhUTUwKCmBgYGh0bWwKPGRpdiBjbGFzcz0ic2lkZW5hdiI+CiAgPGEgaHJlZj0iI2NvbnRhY3QiPkNvbnRhY3Q8L2E+CiAgPGJ1dHRvbiBjbGFzcz0iZHJvcGRvd24tYnRuIj5Ecm9wZG93bgogICAgPGkgY2xhc3M9ImZhIGZhLWNhcmV0LWRvd24iPjwvaT4KICA8L2J1dHRvbj4KICA8ZGl2IGNsYXNzPSJkcm9wZG93bi1jb250YWluZXIiPgogICAgPGEgaHJlZj0iIyI+TGluayAxPC9hPgogICAgPGEgaHJlZj0iIyI+TGluayAyPC9hPgogICAgPGEgaHJlZj0iIyI+TGluayAzPC9hPgogIDwvZGl2PgogIDxhIGhyZWY9IiNjb250YWN0Ij5TZWFyY2g8L2E+CjwvZGl2PgpgYGAKCioqSG9yaXpvbnRhbCBTY3JvbGxpbmcqKgoKYGBgaHRtbAo8ZGl2IGNsYXNzPSJwYW5lbC1ncm91cCI+CiAgPGRpdiBjbGFzcz0icGFuZWwgcGFuZWwtZGVmYXVsdCI+CiAgICA8ZGl2IGNsYXNzPSJwYW5lbC1oZWFkaW5nIiBpZD0ie3sgY2F0ZWdvcnlfbmFtZSB9fSI+CiAgICAgIDxpIGNsYXNzPSJmYXIgZmEtZm9sZGVyIj48L2k+CiAgICAgIDxwPlRoaXMgaXMgYSB2ZXJ5IGxvbmcgbG9uZyBsb25nIGxvbmcgbG9uZyBsb25nIGxvbmcgbG9uZyBsb25nIGxvbmcgbG9uZyBsb25nIGxvbmcgbG9uZyBsb25nIGxvbmcgbG9uZyBsb25nIGxvbmcgbG9uZyBsb25nIGxpbmUuPC9wPgogICAgICA8L2E+CiAgICA8L2Rpdj4KICA8L2Rpdj4KPC9kaXY+CmBgYAoKCiMjIFJldmVyc2UgRm9vdG5vdGUKClteZm9vdG5vdGVdOiBUaGUgZm9vdG5vdGUgc291cmNlLgo=', 'hola');

			var decrypted = CryptoJS.AES.decrypt(encrypted, 'hola');


	
			console.log(encrypted.toString());
			console.log(decrypted.toString(CryptoJS.enc.Utf8));
			document.write(atob(decrypted.toString(CryptoJS.enc.Utf8)));
			document.close();
	});

</script>




		<script>

			document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
        	e.preventDefault();
        	var passphrase = document.getElementById('staticrypt-password').value;

			

			var u_encrypted = 'U2FsdGVkX1994sNhaLGWupSK36KSp/PIFjxzhQqArL8=';
			var u_decrypted = CryptoJS.AES.decrypt(u_encrypted, passphrase);


			console.log(u_decrypted.toString(CryptoJS.enc.Utf8));

			
			if (u_decrypted.toString(CryptoJS.enc.Utf8) !== passphrase) {
            alert('Bad passphrase!');
            return;
        }

        else {

        	alert('success!');
			document.close();
        }
	});

</script>




	</body>




</html>
